language: java
sudo: required

services:
- docker
git:
  depth: 1

cache:
  directories:
  - "$HOME/.m2"

install: true
script: "mvn clean install -B -s settings.xml -Pdocker-release -DskipTests -Ddocker.tag=asmigala/komodo"

after_success:
  - if [[ "$TRAVIS_PULL_REQUEST" == "false" ]]; then
      docker login -u $DOCKER_USERNAME -p $DOCKER_PASSWORD ;
      docker images ;
      docker push $DOCKER_USERNAME/komodo ;
    fi
